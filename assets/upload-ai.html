<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AIStore ‚Äî Upload</title>
  <link rel="stylesheet" href="../styles.css?v=12" />
</head>

<body>
  <div class="page">
    <header class="topbar">
      <div class="container topbarInner">
        <a class="brand" href="../index.html">
          <span class="lambda">Œõ</span><span class="brandText">ISTORE</span>
        </a>

        <nav class="topnav topnav--pill">
          <a class="navLink" href="celebrity.html" data-i18n="nav.celebrity">Celebrity AIs</a>
          <a class="navLink" href="upload-ai.html" data-i18n="nav.upload">Upload</a>
          <a class="navLink" href="../pricing.html" data-i18n="nav.pricing">Pricing</a>

          <div class="langMenu" id="langMenu">
            <button class="langBtnMini" type="button" aria-haspopup="listbox" aria-expanded="false">
              <span class="langIcon">üåê</span>
              <span class="langValue" id="langValue">EN</span>
              <span class="langChevron">‚ñæ</span>
            </button>
            <div class="langList" role="listbox" aria-label="Language">
              <button class="langOption is-active" type="button" data-lang="en">EN</button>
              <button class="langOption" type="button" data-lang="tr">TR</button>
            </div>
          </div>
        </nav>
      </div>
    </header>

    <main class="container" style="padding: 44px 0 64px;">
      <h1 style="margin:0; font-size: clamp(34px, 4vw, 52px); letter-spacing:-.02em;">
        <span data-i18n="upload.title">Upload Your</span> <span class="lambda">Œõ</span><span data-i18n="cat.ai">I</span>
      </h1>

      <p style="margin:10px 0 0; color: rgba(234,243,255,.80); line-height:1.6; max-width: 760px;"
         data-i18n="upload.sub">
        MVP page: share a few details. Later we‚Äôll add pricing, versions, reviews, and publishing.
      </p>

      <div class="formCard">
        <div class="fieldGrid">
          <div>
            <label class="label" for="aiName" data-i18n="upload.ai_name">AI Name</label>
            <input class="input" id="aiName" placeholder="e.g., Finance ŒõI" />
          </div>

          <div>
            <label class="label" for="aiCategory" data-i18n="upload.category">Category</label>
            <input class="input" id="aiCategory" placeholder="e.g., Finance" />
          </div>

          <div style="grid-column: 1 / -1;">
            <label class="label" for="aiDesc" data-i18n="upload.desc">Short Description</label>
            <textarea class="textarea" id="aiDesc" rows="4" placeholder="What does your AI do?"></textarea>
          </div>

          <!-- ‚úÖ Investor Demo Brain Builder (NEW) -->
          <div style="grid-column: 1 / -1;">
            <label class="label" for="aiInstruction">How should I answer? (Expert Instruction)</label>
            <textarea class="textarea" id="aiInstruction" rows="4"
              placeholder="e.g., I am a finance expert. Answer structured. Always end with disclaimer + signature."></textarea>
          </div>

          <div>
            <label class="label" for="aiSignature">Signature</label>
            <input class="input" id="aiSignature" placeholder="e.g., ‚Äî B√º≈üra | AIStore Finance Expert" />
          </div>

          <div>
            <label class="label" for="aiDisclaimer">Mandatory closing line</label>
            <input class="input" id="aiDisclaimer" placeholder="e.g., Bu bir yatƒ±rƒ±m tavsiyesi deƒüildir." />
          </div>
        </div>

        <div style="margin-top:16px; display:flex; gap:12px; flex-wrap:wrap;">
          <button class="cta primary" type="button" id="submitMvp" style="min-width:220px;" data-i18n="upload.submit">Submit (MVP)</button>
          <a class="cta secondary" href="../index.html" style="min-width:220px;" data-i18n="upload.back">Back to Home</a>
        </div>
      </div>

      <div class="demoCard">
        <div style="font-weight:900; margin-bottom:10px;" data-i18n="demo.quick_title">Investor Demo Personas</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button type="button" class="cta secondary" id="personaFamily" style="min-width:260px;" data-i18n="demo.persona_family">Life & Family ‚Ä¢ Psychologist</button>
          <button type="button" class="cta secondary" id="personaFinance" style="min-width:260px;" data-i18n="demo.persona_finance">Finance ‚Ä¢ Advisor</button>
        </div>

        <div id="expertBadge" style="margin-top:12px; padding:12px; border-radius:14px; background: rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.16);">
          <b data-i18n="demo.selected">Selected expert:</b> <span data-i18n="demo.none">None yet</span>
        </div>

        <div style="margin-top:8px; font-size:12px; color: rgba(234,243,255,.8);" data-i18n="demo.tip">
          Tip: Click a persona (recommended) or fill the form and press ‚ÄúSubmit (MVP)‚Äù to use your own expert profile in the live demo below.
        </div>
      </div>

      <div class="demoCard">
        <h2 style="margin:0 0 10px 0;">Expert AI Demo</h2>

        <div id="expertChatBox" class="chatBox">
          <div style="margin:8px 0;"><b>AI:</b> <span data-i18n="chat.hello">Hi! Ask me anything.</span></div>
        </div>

        <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
          <input id="expertMsg" class="input" style="flex:1; min-width:260px;" placeholder="Type your question..." />
          <button id="expertSend" class="cta primary" type="button" style="min-width:180px;">
            <span data-i18n="demo.send">Send</span>
          </button>
        </div>

        <div id="expertStatus" style="margin-top:8px; font-size:12px; color: rgba(234,243,255,.8);"></div>
      </div>
    </main>

    <footer class="footer">
      <div class="container footerInner">
        <div class="footerBrand"><span class="lambda">Œõ</span>ISTORE</div>
        <div class="footerLinks">
          <a href="upload-ai.html" data-i18n="footer.upload">Upload</a>
          <a href="celebrity.html" data-i18n="footer.celebrity">Celebrity AIs</a>
          <a href="#" data-i18n="footer.terms">Terms</a>
          <a href="#" data-i18n="footer.privacy">Privacy</a>
          <a href="../pricing.html" data-i18n="footer.pricing">Pricing</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // --- i18n (same behavior as index) ---
    (function(){
      const DICT = {
        en: {
          "nav.celebrity":"Celebrity AIs","nav.upload":"Upload","nav.pricing":"Pricing",
          "upload.title":"Upload Your","cat.ai":"I",
          "upload.sub":"MVP page: share a few details. Later we‚Äôll add pricing, versions, reviews, and publishing.",
          "upload.ai_name":"AI Name","upload.category":"Category","upload.desc":"Short Description",
          "upload.submit":"Submit (MVP)","upload.back":"Back to Home",
          "demo.quick_title":"Investor Demo Personas",
          "demo.persona_family":"Life & Family ‚Ä¢ Psychologist",
          "demo.persona_finance":"Finance ‚Ä¢ Advisor",
          "demo.selected":"Selected expert:",
          "demo.none":"None yet",
          "demo.tip":"Tip: Click a persona (recommended) or fill the form and press ‚ÄúSubmit (MVP)‚Äù to use your own expert profile in the live demo below.",
          "demo.send":"Send",
          "chat.hello":"Hi! Ask me anything.",
          "footer.upload":"Upload","footer.celebrity":"Celebrity AIs","footer.terms":"Terms","footer.privacy":"Privacy","footer.pricing":"Pricing"
        },
        tr: {
          "nav.celebrity":"√únl√º AI‚Äôlar","nav.upload":"Y√ºkle","nav.pricing":"Fiyatlar",
          "upload.title":"Yapay Zek√¢nƒ± Y√ºkle","cat.ai":"I",
          "upload.sub":"MVP sayfasƒ±: birka√ß bilgi payla≈ü. Sonra fiyatlama, versiyonlar, deƒüerlendirmeler ve yayƒ±nlama eklenecek.",
          "upload.ai_name":"AI Adƒ±","upload.category":"Kategori","upload.desc":"Kƒ±sa A√ßƒ±klama",
          "upload.submit":"G√∂nder (MVP)","upload.back":"Ana sayfaya d√∂n",
          "demo.quick_title":"Yatƒ±rƒ±mcƒ± Demo Personalarƒ±",
          "demo.persona_family":"Life & Family ‚Ä¢ Psikolog",
          "demo.persona_finance":"Finance ‚Ä¢ Danƒ±≈üman",
          "demo.selected":"Se√ßili uzman:",
          "demo.none":"Hen√ºz se√ßilmedi",
          "demo.tip":"ƒ∞pucu: Bir persona se√ß (√∂nerilir) veya formu doldurup ‚ÄúG√∂nder (MVP)‚Äù butonuna bas ‚Äî a≈üaƒüƒ±daki canlƒ± demoda kendi uzman profilinle cevap alƒ±rsƒ±n.",
          "demo.send":"G√∂nder",
          "chat.hello":"Merhaba! Bana bir soru sorabilirsin.",
          "footer.upload":"Y√ºkle","footer.celebrity":"√únl√º AI‚Äôlar","footer.terms":"Ko≈üullar","footer.privacy":"Gizlilik","footer.pricing":"Fiyatlar"
        }
      };

      function getLang(){
        const p=new URLSearchParams(location.search);
        const l=(p.get("lang")||"").toLowerCase();
        if(l==="tr"||l==="en") return l;
        try{
          const s=(localStorage.getItem("aistore_lang")||"").toLowerCase();
          if(s==="tr"||s==="en") return s;
        }catch(e){}
        return "en";
      }

      function applyLang(lang){
        lang = (lang==="tr") ? "tr" : "en";
        document.documentElement.lang = lang;

        document.querySelectorAll("[data-i18n]").forEach(el=>{
          const key=el.getAttribute("data-i18n");
          const val=DICT?.[lang]?.[key];
          if(!val) return;
          el.textContent = val;
        });

        const langValue=document.getElementById("langValue");
        if(langValue) langValue.textContent = lang.toUpperCase();

        document.querySelectorAll(".langOption").forEach(b=>{
          b.classList.toggle("is-active", b.dataset.lang===lang);
        });

        try{ localStorage.setItem("aistore_lang", lang); }catch(e){}
        const url=new URL(location.href); url.searchParams.set("lang", lang);
        history.replaceState({}, "", url.toString());

        document.querySelectorAll('a[href]').forEach(a=>{
          const href=a.getAttribute("href");
          if(!href || href.startsWith("#") || href.startsWith("mailto:") || href.startsWith("http")) return;
          const u=new URL(href, location.href);
          u.searchParams.set("lang", lang);
          a.setAttribute("href", u.pathname + "?" + u.searchParams.toString() + u.hash);
        });
      }

      const menu=document.getElementById("langMenu");
      if(menu){
        const btn=menu.querySelector(".langBtnMini");
        const list=menu.querySelector(".langList");
        function close(){ menu.classList.remove("open"); btn.setAttribute("aria-expanded","false"); }
        btn.addEventListener("click",(e)=>{
          e.stopPropagation();
          const o=menu.classList.toggle("open");
          btn.setAttribute("aria-expanded", o?"true":"false");
        });
        list.addEventListener("click",(e)=>{
          const opt=e.target.closest(".langOption");
          if(!opt) return;
          applyLang(opt.dataset.lang);
          close();
        });
        document.addEventListener("click", close);
        document.addEventListener("keydown",(e)=>{ if(e.key==="Escape") close(); });
      }

      applyLang(getLang());
    })();

    // --- Demo Chat (API: /api/chat) ---
    (function(){
      let CURRENT_EXPERT = null;

      function getLang(){
        const p=new URLSearchParams(location.search);
        const l=(p.get("lang")||"").toLowerCase();
        return (l==="tr" ? "tr" : "en");
      }

      function escapeHtml(str){
        return String(str)
          .replaceAll("&","&amp;")
          .replaceAll("<","&lt;")
          .replaceAll(">","&gt;")
          .replaceAll('"',"&quot;")
          .replaceAll("'","&#039;");
      }

      function setSelectedExpert(expert){
        CURRENT_EXPERT = expert;
        const badge = document.getElementById("expertBadge");
        const lang = getLang();
        const label = (lang === "tr") ? "Se√ßili uzman:" : "Selected expert:";
        badge.innerHTML =
          `<b>${label}</b> <b>${escapeHtml(expert.name)}</b> ‚Ä¢ ${escapeHtml(expert.category)}<br>` +
          `<span style="opacity:.85">${escapeHtml(expert.description || "")}</span>`;
      }

      function expertFromForm(){
        const name = (document.getElementById("aiName")?.value || "").trim();
        const category = (document.getElementById("aiCategory")?.value || "").trim();
        const desc = (document.getElementById("aiDesc")?.value || "").trim();

        const instruction = (document.getElementById("aiInstruction")?.value || "").trim();
        const signature = (document.getElementById("aiSignature")?.value || "").trim();
        const disclaimer = (document.getElementById("aiDisclaimer")?.value || "").trim();

        const lang = getLang();
        return {
          name: name || (lang === "tr" ? "Kariyer Ko√ßu ŒõI" : "Career Coach ŒõI"),
          category: category || (lang === "tr" ? "Kariyer" : "Career"),
          description: desc || (lang === "tr"
            ? "Net hedefler, adƒ±m adƒ±m plan ve g√º√ßl√º motivasyon."
            : "Clear goals, step-by-step plan, strong motivation."),
          instruction,
          signature,
          disclaimer
        };
      }

      function initDemo(){
        const family = {
          name: "Life & Family Psychologist ŒõI",
          category: "Life & Family",
          description: "Supportive, structured guidance for relationships, parenting, and daily wellbeing.",
          instruction: "You are a supportive psychologist. Ask 1-2 clarifying questions if needed. Be practical, empathetic, and structured. Avoid diagnosis. End with the mandatory closing line and signature.",
          disclaimer: "This is not a medical diagnosis. If you feel unsafe or symptoms are severe, seek professional help immediately.",
          signature: "‚Äî AIStore | Psychologist Expert"
        };
        const finance = {
          name: "Finance Advisor ŒõI",
          category: "Finance",
          description: "Practical budgeting, savings, and decision frameworks ‚Äî with clear caveats.",
          instruction: "You are a finance expert. Be structured (bullets + short steps). State assumptions. Give options and risks. Never promise returns. End with the mandatory closing line and signature.",
          disclaimer: "Bu bir yatƒ±rƒ±m tavsiyesi deƒüildir.",
          signature: "‚Äî AIStore | Finance Expert"
        };

        document.getElementById("personaFamily")?.addEventListener("click", ()=>setSelectedExpert(family));
        document.getElementById("personaFinance")?.addEventListener("click", ()=>setSelectedExpert(finance));

        document.getElementById("submitMvp")?.addEventListener("click", ()=>{
          setSelectedExpert(expertFromForm());
          document.getElementById("expertChatBox")?.scrollIntoView({behavior:"smooth", block:"start"});
        });

        // default persona
        setSelectedExpert(family);

        const input = document.getElementById("expertMsg");
        input?.addEventListener("keydown",(e)=>{
          if(e.key==="Enter"){ e.preventDefault(); sendExpert(); }
        });

        document.getElementById("expertSend")?.addEventListener("click", sendExpert);
      }

      async function sendExpert(){
        const input = document.getElementById("expertMsg");
        const box = document.getElementById("expertChatBox");
        const status = document.getElementById("expertStatus");
        const btn = document.getElementById("expertSend");

        const text = (input.value || "").trim();
        if(!text) return;

        const lang = getLang();
        const youLabel = (lang === "tr") ? "Sen" : "You";

        box.innerHTML += `<div style="margin:8px 0; text-align:right;"><b>${youLabel}:</b> ${escapeHtml(text)}</div>`;
        input.value = "";
        status.textContent = (lang === "tr") ? "Cevap hazƒ±rlanƒ±yor..." : "Generating answer...";
        btn.disabled = true;

        if(!CURRENT_EXPERT) CURRENT_EXPERT = expertFromForm();

        try{
          const res = await fetch("/api/chat", {
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body: JSON.stringify({ message: text, expert: CURRENT_EXPERT, lang })
          });

          const data = await res.json().catch(()=> ({}));
          if(!res.ok) throw new Error(data.error || ("HTTP " + res.status));

          box.innerHTML += `<div style="margin:8px 0;"><b>AI:</b> ${escapeHtml(data.answer || "")}</div>`;
          status.textContent = (lang === "tr") ? "Tamam." : "Done.";
        }catch(e){
          status.textContent = ((lang === "tr") ? "Hata: " : "Error: ") + (e.message || String(e));
        }finally{
          btn.disabled = false;
          box.scrollTop = box.scrollHeight;
        }
      }

      document.addEventListener("DOMContentLoaded", initDemo);
    })();
  </script>
</body>
</html>
