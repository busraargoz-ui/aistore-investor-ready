<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AIStore ‚Äî Upload</title>
  <link rel="stylesheet" href="../styles.css" />
</head>

<body>
  <div class="page">
    <header class="topbar">
      <div class="topbarInner">
        <a class="brand" href="../index.html">
          <span class="lambda">Œõ</span><span class="brandText">ISTORE</span>
        </a>

        <nav class="topnav topnav--pill">
          <a class="navLink" href="celebrity.html" data-i18n="nav.celebrity">Celebrity AIs</a>
          <a class="navLink" href="upload-ai.html" data-i18n="nav.upload">Upload</a>

          <div class="langMenu" id="langMenu">
            <button class="langBtnMini" type="button" aria-haspopup="listbox" aria-expanded="false">
              <span class="langIcon">üåê</span>
              <span class="langValue" id="langValue">EN</span>
              <span class="langChevron">‚ñæ</span>
            </button>
            <div class="langList" role="listbox" aria-label="Language">
              <button class="langOption is-active" type="button" data-lang="en">EN</button>
              <button class="langOption" type="button" data-lang="tr">TR</button>
            </div>
          </div>
        </nav>
      </div>
    </header>

    <main class="container" style="padding: 40px 0 60px;">
      <h1 style="margin:0; font-size: clamp(34px, 4vw, 52px); letter-spacing:-.02em;">
        <span data-i18n="upload.title">Upload Your</span> <span class="lambda">Œõ</span><span data-i18n="cat.ai">I</span>
      </h1>

      <p style="margin:10px 0 0; color: rgba(234,243,255,.8); line-height:1.6; max-width: 760px;"
         data-i18n="upload.sub">
        MVP page: share a few details. Later we‚Äôll add pricing, versions, reviews, and publishing.
      </p>

      <div style="margin-top:22px; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:22px; padding:22px; max-width: 820px;">
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:14px;">
          <div>
            <label style="display:block; font-weight:800; margin-bottom:8px;" data-i18n="upload.ai_name">AI Name</label>
            <input id="aiName" placeholder="e.g., Finance ŒõI" style="width:100%; padding:12px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.16); background: rgba(0,0,0,.18); color:#fff;">
          </div>

          <div>
            <label style="display:block; font-weight:800; margin-bottom:8px;" data-i18n="upload.category">Category</label>
            <input id="aiCategory" placeholder="e.g., Finance" style="width:100%; padding:12px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.16); background: rgba(0,0,0,.18); color:#fff;">
          </div>

          <div style="grid-column: 1 / -1;">
            <label style="display:block; font-weight:800; margin-bottom:8px;" data-i18n="upload.desc">Short Description</label>
            <textarea id="aiDesc" rows="4" placeholder="What does your AI do?"
              style="width:100%; padding:12px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.16); background: rgba(0,0,0,.18); color:#fff;"></textarea>
          </div>
        </div>

        <div style="margin-top:16px; display:flex; gap:12px; flex-wrap:wrap;">
          <button class="cta primary" type="button" id="submitMvp" style="min-width:200px;" data-i18n="upload.submit">Submit (MVP)</button>
          <a class="cta secondary" href="../index.html" style="min-width:200px;" data-i18n="upload.back">Back to Home</a>
        </div>
      </div>

      
      <!-- ‚úÖ Investor Demo: 2 ready personas -->
      <div style="max-width:820px; margin:22px 0 0; padding:16px; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:18px;">
        <div style="font-weight:800; margin-bottom:10px;" data-i18n="demo.quick_title">Investor Demo Personas</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button type="button" class="cta secondary" id="personaFamily" style="min-width:240px;" data-i18n="demo.persona_family">Life & Family ‚Ä¢ Psychologist</button>
          <button type="button" class="cta secondary" id="personaFinance" style="min-width:240px;" data-i18n="demo.persona_finance">Finance ‚Ä¢ Advisor</button>
        </div>
        <div id="expertBadge" style="margin-top:12px; padding:12px; border-radius:14px; background: rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.16); color:#fff;">
          <b data-i18n="demo.selected">Selected expert:</b> <span data-i18n="demo.none">None yet</span>
        </div>
        <div style="margin-top:8px; font-size:12px; color: rgba(234,243,255,.8);" data-i18n="demo.tip">
          Tip: Click a persona (recommended) or fill the form and press ‚ÄúSubmit (MVP)‚Äù to use your own expert profile in the live demo below.
        </div>
      </div>

<!-- ‚úÖ SINGLE WORKING CHAT (no duplicate ids) -->
      <div style="max-width:820px; margin:22px 0 0; padding:18px; background:#ffffff; border-radius:18px;">
        <h2 style="margin:0 0 10px 0; color:#111;">Expert AI Demo</h2>

        <div id="expertChatBox" style="min-height:160px; background:#f7f7f7; border:1px solid #e1e1e1; border-radius:12px; padding:12px; color:#111; overflow:auto;">
          <div style="margin:8px 0;"><b>AI:</b> Merhaba! Uzmana bir soru sorabilirsin.</div>
        </div>

        <div style="display:flex; gap:10px; margin-top:10px;">
          <input id="expertMsg" placeholder="Type your question..." style="flex:1; padding:12px; border-radius:12px; border:1px solid #d0d0d0;">
          <button id="expertSend" onclick="sendExpert()" style="padding:12px 14px; border-radius:12px; border:1px solid #d0d0d0; cursor:pointer;">
            G√∂nder
          </button>
        </div>

        <div id="expertStatus" style="margin-top:8px; font-size:12px; color:#666;"></div>
      </div>
    </main>

    <footer class="footer">
      <div class="container footerInner">
        <div class="footerBrand"><span class="lambda">Œõ</span>ISTORE</div>
        <div class="footerLinks">
          <a href="upload-ai.html" data-i18n="footer.upload">Upload</a>
          <a href="celebrity.html" data-i18n="footer.celebrity">Celebrity AIs</a>
          <a href="#" data-i18n="footer.terms">Terms</a>
          <a href="#" data-i18n="footer.privacy">Privacy</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    (function(){
      const DICT = {
        en: {
          "nav.celebrity":"Celebrity AIs","nav.upload":"Upload",
          "cat.ai":"I",
          "upload.title":"Upload Your","upload.sub":"MVP page: share a few details. Later we‚Äôll add pricing, versions, reviews, and publishing.",
          "upload.ai_name":"AI Name","upload.category":"Category","upload.desc":"Short Description",
          "upload.submit":"Submit (MVP)","upload.back":"Back to Home",
          "footer.upload":"Upload","footer.celebrity":"Celebrity AIs","footer.terms":"Terms","demo.quick_title":"Investor Demo Personas","demo.persona_family":"Life & Family ‚Ä¢ Psychologist","demo.persona_finance":"Finance ‚Ä¢ Advisor","demo.selected":"Selected expert:","demo.none":"None yet","demo.tip":"Tip: Click a persona (recommended) or fill the form and press ‚ÄúSubmit (MVP)‚Äù to use your own expert profile in the live demo below.","demo.send":"Send","footer.privacy":"Privacy"
        },
        tr: {
          "nav.celebrity":"Celebrity AI‚Äôlar","nav.upload":"Y√ºkle",
          "cat.ai":"I",
          "upload.title":"AI‚Äôƒ±nƒ± Y√ºkle","upload.sub":"MVP sayfasƒ±: birka√ß bilgi payla≈ü. Sonra fiyatlama, versiyonlar, deƒüerlendirmeler ve yayƒ±nlama eklenecek.",
          "upload.ai_name":"AI Adƒ±","upload.category":"Kategori","upload.desc":"Kƒ±sa A√ßƒ±klama",
          "upload.submit":"G√∂nder (MVP)","upload.back":"Ana sayfaya d√∂n",
          "footer.upload":"Y√ºkle","footer.celebrity":"Celebrity AI‚Äôlar","footer.terms":"Ko≈üullar","demo.quick_title":"Yatƒ±rƒ±mcƒ± Demo Personalarƒ±","demo.persona_family":"Life & Family ‚Ä¢ Psikolog","demo.persona_finance":"Finance ‚Ä¢ Danƒ±≈üman","demo.selected":"Se√ßili uzman:","demo.none":"Hen√ºz se√ßilmedi","demo.tip":"ƒ∞pucu: Bir persona se√ß (√∂nerilir) veya formu doldurup ‚ÄúSubmit (MVP)‚Äù butonuna bas ‚Äî a≈üaƒüƒ±daki canlƒ± demoda kendi uzman profilinle cevap alƒ±rsƒ±n.","demo.send":"G√∂nder","footer.privacy":"Gizlilik"
        }
      };

      function getLang(){
        const p = new URLSearchParams(location.search);
        const l = (p.get("lang")||"").toLowerCase();
        if (l==="tr"||l==="en") return l;
        try{
          const s=(localStorage.getItem("aistore_lang")||"").toLowerCase();
          if (s==="tr"||s==="en") return s;
        }catch(e){}
        return "en";
      }

      function setLang(lang){
        lang = (lang==="tr") ? "tr":"en";
        document.documentElement.lang = lang;
        document.querySelectorAll("[data-i18n]").forEach(el=>{
          const key=el.getAttribute("data-i18n");
          const val=DICT[lang][key];
          if (val) el.textContent = val;
        });

        const langValue=document.getElementById("langValue");
        if (langValue) langValue.textContent = (lang==="tr"?"TR":"EN");
        document.querySelectorAll(".langOption").forEach(b=>b.classList.toggle("is-active", b.dataset.lang===lang));

        try{ localStorage.setItem("aistore_lang", lang); }catch(e){}
        const url=new URL(location.href); url.searchParams.set("lang", lang);
        history.replaceState({}, "", url.toString());

        document.querySelectorAll('a[href]').forEach(a=>{
          const href=a.getAttribute("href");
          if(!href || href.startsWith("#") || href.startsWith("mailto:") || href.startsWith("http")) return;
          const u=new URL(href, location.href);
          u.searchParams.set("lang", lang);
          const qs = u.searchParams.toString();
          a.setAttribute("href", u.pathname + (qs ? "?" + qs : "") + u.hash);
        });
      }

      const menu=document.getElementById("langMenu");
      if(menu){
        const btn=menu.querySelector(".langBtnMini");
        const list=menu.querySelector(".langList");
        function close(){ menu.classList.remove("open"); btn.setAttribute("aria-expanded","false"); }
        btn.addEventListener("click",(e)=>{ e.stopPropagation(); const o=menu.classList.toggle("open"); btn.setAttribute("aria-expanded", o?"true":"false"); });
        list.addEventListener("click",(e)=>{ const opt=e.target.closest(".langOption"); if(!opt) return; setLang(opt.dataset.lang); close(); });
        document.addEventListener("click", close);
        document.addEventListener("keydown",(e)=>{ if(e.key==="Escape") close(); });
      }

      setLang(getLang());
    })();
// --- Investor Demo state ---
let CURRENT_EXPERT = null;
    function getLang(){
      const url = new URL(window.location.href);
      const q = (url.searchParams.get("lang") || "").toLowerCase();
      if(q === "tr" || q === "en") return q;
      // fallback to html lang
      const hl = (document.documentElement.lang || "en").toLowerCase();
      return (hl.startsWith("tr") ? "tr" : "en");
    }

    function setSelectedExpert(expert){
      CURRENT_EXPERT = expert;
      const badge = document.getElementById("expertBadge");
      if(!badge) return;

      const lang = getLang();
      const label = (lang === "tr") ? "Se√ßili uzman:" : "Selected expert:";
      badge.innerHTML = `<b>${label}</b> <b>${escapeHtml(expert.name)}</b> ‚Ä¢ ${escapeHtml(expert.category)}<br><span style="opacity:.85">${escapeHtml(expert.description || "")}</span>`;
    }

    function expertFromForm(){
      const name = (document.getElementById("aiName")?.value || "").trim();
      const category = (document.getElementById("aiCategory")?.value || "").trim();
      const desc = (document.getElementById("aiDesc")?.value || "").trim();

      const lang = getLang();
      return {
        name: name || (lang === "tr" ? "Kariyer Ko√ßu ŒõI" : "Career Coach ŒõI"),
        category: category || (lang === "tr" ? "Kariyer" : "Career"),
        description: desc || (lang === "tr" ? "Net hedefler, adƒ±m adƒ±m plan ve g√º√ßl√º motivasyon." : "Clear goals, step-by-step plan, strong motivation.")
      };
    }

    function initDemo(){
      // Preset personas (2 personas as you requested)
      const family = {
        name: "Life & Family Psychologist ŒõI",
        category: "Life & Family",
        description: "Supportive, structured guidance for relationships, parenting, and daily wellbeing."
      };
      const finance = {
        name: "Finance Advisor ŒõI",
        category: "Finance",
        description: "Practical budgeting, savings, and decision frameworks ‚Äî with clear caveats."
      };

      // Buttons
      const b1 = document.getElementById("personaFamily");
      const b2 = document.getElementById("personaFinance");
      b1?.addEventListener("click", () => setSelectedExpert(family));
      b2?.addEventListener("click", () => setSelectedExpert(finance));

      // Submit (MVP) uses the form as the expert profile
      document.getElementById("submitMvp")?.addEventListener("click", () => {
        setSelectedExpert(expertFromForm());
        // smooth scroll to chat
        document.getElementById("expertChatBox")?.scrollIntoView({behavior:"smooth", block:"start"});
      });

      // Default: pick family persona for a strong first impression
      setSelectedExpert(family);

      // Enter to send
      const input = document.getElementById("expertMsg");
      input?.addEventListener("keydown", (e) => {
        if(e.key === "Enter"){
          e.preventDefault();
          sendExpert();
        }
      });
    }

    async function sendExpert(){
      const input = document.getElementById("expertMsg");
      const box = document.getElementById("expertChatBox");
      const status = document.getElementById("expertStatus");
      const btn = document.getElementById("expertSend");

      const text = (input.value || "").trim();
      if(!text) return;

      const lang = getLang();
      const youLabel = (lang === "tr") ? "Sen" : "You";
      box.innerHTML += `<div style="margin:8px 0; text-align:right;"><b>${youLabel}:</b> ${escapeHtml(text)}</div>`;
      input.value = "";
      status.textContent = (lang === "tr") ? "Cevap hazƒ±rlanƒ±yor..." : "Generating answer...";
      btn.disabled = true;

      // Ensure expert exists
      if(!CURRENT_EXPERT) CURRENT_EXPERT = expertFromForm();

      try{
        const res = await fetch("/api/chat", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body: JSON.stringify({ message: text, expert: CURRENT_EXPERT, lang })
        });
        const data = await res.json();
        if(!res.ok) throw new Error(data.error || "API error");

        box.innerHTML += `<div style="margin:8px 0;"><b>AI:</b> ${escapeHtml(data.answer || "")}</div>`;
        status.textContent = (lang === "tr") ? "Tamam." : "Done.";
      }catch(e){
        status.textContent = ((lang === "tr") ? "Hata: " : "Error: ") + (e.message || String(e));
      }finally{
        btn.disabled = false;
        box.scrollTop = box.scrollHeight;
      }
    }

    document.addEventListener("DOMContentLoaded", initDemo);
    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
  </script>
  <script>
document.addEventListener("DOMContentLoaded", function() {

  if (btn1) {
    btn1.addEventListener("click", function() {
      selected.textContent = "Life & Family ‚Ä¢ Psychologist";
    });
  }

  if (btn2) {
    btn2.addEventListener("click", function() {
      selected.textContent = "Finance ‚Ä¢ Advisor";
    });
  }
});
</script>
</body>
</html>
