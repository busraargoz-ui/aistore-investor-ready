<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AIStore ‚Äî Upload</title>
  <link rel="stylesheet" href="../styles.css?v=12">

</head>

<body>
  <div class="page">
    <header class="topbar">
      <div class="container topbarInner">
        <a class="brand" href="index.html">
          <span class="lambda">Œõ</span><span class="brandText">ISTORE</span>
        </a>

        <nav class="topnav topnav--pill">
          <a class="navLink" href="celebrity.html" data-i18n="nav.celebrity">Celebrity AIs</a>
          <a class="navLink" href="upload-ai.html" data-i18n="nav.upload">Upload</a>
          <a class="navLink" href="pricing.html" data-i18n="nav.pricing">Pricing</a>

          <div class="langMenu" id="langMenu">
            <button class="langBtnMini" type="button" aria-haspopup="listbox" aria-expanded="false">
              <span class="langIcon">üåê</span>
              <span class="langValue" id="langValue">EN</span>
              <span class="langChevron">‚ñæ</span>
            </button>
            <div class="langList" role="listbox" aria-label="Language">
              <button class="langOption is-active" type="button" data-lang="en">EN</button>
              <button class="langOption" type="button" data-lang="tr">TR</button>
            </div>
          </div>
        </nav>
      </div>
    </header>

    <main class="container section">
      <h1 class="pageTitle">
        <span data-i18n="upload.title">Upload Your</span> <span class="lambda">Œõ</span><span data-i18n="cat.ai">I</span>
      </h1>
      <p class="pageLead" data-i18n="upload.sub">
        MVP page: share a few details. Later we‚Äôll add pricing, versions, reviews, and publishing.
      </p>

      <div class="card">
        <div class="formGrid">
          <div>
            <label class="label" data-i18n="upload.ai_name">AI Name</label>
            <input class="input" id="aiName" placeholder="e.g., Finance ŒõI">
          </div>

          <div>
            <label class="label" data-i18n="upload.category">Category</label>
            <input class="input" id="aiCategory" placeholder="e.g., Finance">
          </div>

          <div class="full">
            <label class="label" data-i18n="upload.desc">Short Description</label>
            <textarea class="textarea" id="aiDesc" rows="4" placeholder="What does your AI do?"></textarea>
          </div>
        </div>

        <div class="btnRow">
          <button class="cta primary" type="button" id="submitMvp" data-i18n="upload.submit">Submit (MVP)</button>
          <a class="cta secondary" href="index.html" data-i18n="upload.back">Back to Home</a>
        </div>
      </div>

      <div class="card" style="margin-top:16px;">
        <div class="cardTitle" data-i18n="demo.quick_title">Investor Demo Personas</div>
        <div class="btnRow" style="margin-top:10px;">
          <button type="button" class="cta secondary" id="personaFamily" data-i18n="demo.persona_family">Life & Family ‚Ä¢ Psychologist</button>
          <button type="button" class="cta secondary" id="personaFinance" data-i18n="demo.persona_finance">Finance ‚Ä¢ Advisor</button>
        </div>

        <div class="badgeBox" id="expertBadge">
          <b data-i18n="demo.selected">Selected expert:</b> <span data-i18n="demo.none">None yet</span>
        </div>

        <div class="tip" data-i18n="demo.tip">
          Tip: Click a persona (recommended) or fill the form and press ‚ÄúSubmit (MVP)‚Äù to use your own expert profile in the live demo below.
        </div>
      </div>

      <div class="chatCard">
        <h2 class="chatTitle">Expert AI Demo</h2>

        <div class="chatBox" id="expertChatBox">
          <div class="chatLine"><b>AI:</b> Merhaba! Uzmana bir soru sorabilirsin.</div>
        </div>

        <div class="chatRow">
          <input class="chatInput" id="expertMsg" placeholder="Type your question...">
          <button class="chatSend" id="expertSend" type="button">Send</button>
        </div>

        <div class="chatStatus" id="expertStatus"></div>
      </div>
    </main>

    <footer class="footer">
      <div class="container footerInner">
        <div class="footerBrand"><span class="lambda">Œõ</span>ISTORE</div>
        <div class="footerLinks">
          <a href="upload-ai.html" data-i18n="footer.upload">Upload</a>
          <a href="celebrity.html" data-i18n="footer.celebrity">Celebrity AIs</a>
          <a href="#" data-i18n="footer.terms">Terms</a>
          <a href="#" data-i18n="footer.privacy">Privacy</a>
          <a href="pricing.html" data-i18n="footer.pricing">Pricing</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    (function(){
      const DICT = {
        en: {
          "nav.celebrity":"Celebrity AIs","nav.upload":"Upload","nav.pricing":"Pricing",
          "cat.ai":"I",
          "upload.title":"Upload Your",
          "upload.sub":"MVP page: share a few details. Later we‚Äôll add pricing, versions, reviews, and publishing.",
          "upload.ai_name":"AI Name","upload.category":"Category","upload.desc":"Short Description",
          "upload.submit":"Submit (MVP)","upload.back":"Back to Home",
          "demo.quick_title":"Investor Demo Personas",
          "demo.persona_family":"Life & Family ‚Ä¢ Psychologist",
          "demo.persona_finance":"Finance ‚Ä¢ Advisor",
          "demo.selected":"Selected expert:",
          "demo.none":"None yet",
          "demo.tip":"Tip: Click a persona (recommended) or fill the form and press ‚ÄúSubmit (MVP)‚Äù to use your own expert profile in the live demo below.",
          "footer.upload":"Upload","footer.celebrity":"Celebrity AIs","footer.terms":"Terms","footer.privacy":"Privacy","footer.pricing":"Pricing"
        },
        tr: {
          "nav.celebrity":"√únl√º AI‚Äôlar","nav.upload":"Y√ºkle","nav.pricing":"Fiyatlar",
          "cat.ai":"I",
          "upload.title":"AI‚Äôƒ±nƒ± Y√ºkle",
          "upload.sub":"MVP sayfasƒ±: birka√ß bilgi payla≈ü. Sonra fiyatlama, versiyonlar, deƒüerlendirmeler ve yayƒ±nlama eklenecek.",
          "upload.ai_name":"AI Adƒ±","upload.category":"Kategori","upload.desc":"Kƒ±sa A√ßƒ±klama",
          "upload.submit":"G√∂nder (MVP)","upload.back":"Ana sayfaya d√∂n",
          "demo.quick_title":"Yatƒ±rƒ±mcƒ± Demo Personalarƒ±",
          "demo.persona_family":"Ya≈üam & Aile ‚Ä¢ Psikolog",
          "demo.persona_finance":"Finans ‚Ä¢ Danƒ±≈üman",
          "demo.selected":"Se√ßili uzman:",
          "demo.none":"Hen√ºz se√ßilmedi",
          "demo.tip":"ƒ∞pucu: Bir persona se√ß (√∂nerilir) veya formu doldurup ‚ÄúG√∂nder (MVP)‚Äù butonuna bas ‚Äî a≈üaƒüƒ±daki canlƒ± demoda kendi uzman profilinle cevap alƒ±rsƒ±n.",
          "footer.upload":"Y√ºkle","footer.celebrity":"√únl√º AI‚Äôlar","footer.terms":"Ko≈üullar","footer.privacy":"Gizlilik","footer.pricing":"Fiyatlar"
        }
      };

      function getLang(){
        const p = new URLSearchParams(location.search);
        const l = (p.get("lang")||"").toLowerCase();
        if (l==="tr"||l==="en") return l;
        try{
          const s=(localStorage.getItem("aistore_lang")||"").toLowerCase();
          if (s==="tr"||s==="en") return s;
        }catch(e){}
        return "en";
      }

      function applyLang(lang){
        lang = (lang==="tr") ? "tr" : "en";
        document.documentElement.lang = lang;

        document.querySelectorAll("[data-i18n]").forEach(el=>{
          const key = el.getAttribute("data-i18n");
          const val = DICT?.[lang]?.[key];
          if(!val) return;
          el.textContent = val;
        });

        const lv = document.getElementById("langValue");
        if(lv) lv.textContent = lang.toUpperCase();

        document.querySelectorAll(".langOption").forEach(x=>{
          x.classList.toggle("is-active", x.getAttribute("data-lang") === lang);
        });

        try{ localStorage.setItem("aistore_lang", lang); }catch(e){}

        const url = new URL(location.href);
        url.searchParams.set("lang", lang);
        history.replaceState({}, "", url.toString());

        document.querySelectorAll('a[href]').forEach(a=>{
          const href = a.getAttribute("href");
          if(!href || href.startsWith("#") || href.startsWith("mailto:") || href.startsWith("http")) return;
          const u = new URL(href, location.href);
          u.searchParams.set("lang", lang);
          const qs = u.searchParams.toString();
          a.setAttribute("href", u.pathname + (qs ? "?" + qs : "") + u.hash);
        });
      }

      // dropdown
      const menu = document.getElementById("langMenu");
      if(menu){
        const btn = menu.querySelector(".langBtnMini");
        const list = menu.querySelector(".langList");
        function close(){ menu.classList.remove("open"); btn.setAttribute("aria-expanded","false"); }
        btn.addEventListener("click", (e)=>{
          e.stopPropagation();
          const open = menu.classList.toggle("open");
          btn.setAttribute("aria-expanded", open ? "true" : "false");
        });
        list.addEventListener("click", (e)=>{
          const opt = e.target.closest(".langOption");
          if(!opt) return;
          applyLang(opt.dataset.lang);
          close();
        });
        document.addEventListener("click", close);
        document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") close(); });
      }

      // Demo chat logic
      let CURRENT_EXPERT = null;

      function escapeHtml(str){
        return String(str)
          .replaceAll("&","&amp;")
          .replaceAll("<","&lt;")
          .replaceAll(">","&gt;")
          .replaceAll('"',"&quot;")
          .replaceAll("'","&#039;");
      }

      function setSelectedExpert(expert){
        CURRENT_EXPERT = expert;
        const badge = document.getElementById("expertBadge");
        const lang = getLang();
        const label = (lang === "tr") ? "Se√ßili uzman:" : "Selected expert:";
        badge.innerHTML = `<b>${label}</b> <b>${escapeHtml(expert.name)}</b> ‚Ä¢ ${escapeHtml(expert.category)}<br><span style="opacity:.85">${escapeHtml(expert.description || "")}</span>`;
      }

      function expertFromForm(){
        const name = (document.getElementById("aiName")?.value || "").trim();
        const category = (document.getElementById("aiCategory")?.value || "").trim();
        const desc = (document.getElementById("aiDesc")?.value || "").trim();
        const lang = getLang();
        return {
          name: name || (lang === "tr" ? "Kariyer Ko√ßu ŒõI" : "Career Coach ŒõI"),
          category: category || (lang === "tr" ? "Kariyer" : "Career"),
          description: desc || (lang === "tr" ? "Net hedefler, adƒ±m adƒ±m plan ve g√º√ßl√º motivasyon." : "Clear goals, step-by-step plan, strong motivation.")
        };
      }

      async function sendExpert(){
        const input = document.getElementById("expertMsg");
        const box = document.getElementById("expertChatBox");
        const status = document.getElementById("expertStatus");
        const btn = document.getElementById("expertSend");

        const text = (input.value || "").trim();
        if(!text) return;

        const lang = getLang();
        const youLabel = (lang === "tr") ? "Sen" : "You";
        box.innerHTML += `<div class="chatLine chatLineYou"><b>${youLabel}:</b> ${escapeHtml(text)}</div>`;
        input.value = "";
        status.textContent = (lang === "tr") ? "Cevap hazƒ±rlanƒ±yor..." : "Generating answer...";
        btn.disabled = true;

        if(!CURRENT_EXPERT) CURRENT_EXPERT = expertFromForm();

        try{
          const res = await fetch("/api/chat", {
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body: JSON.stringify({ message: text, expert: CURRENT_EXPERT, lang })
          });
          const data = await res.json();
          if(!res.ok) throw new Error(data.error || "API error");

          box.innerHTML += `<div class="chatLine"><b>AI:</b> ${escapeHtml(data.answer || "")}</div>`;
          status.textContent = (lang === "tr") ? "Tamam." : "Done.";
        }catch(e){
          status.textContent = ((lang === "tr") ? "Hata: " : "Error: ") + (e.message || String(e));
        }finally{
          btn.disabled = false;
          box.scrollTop = box.scrollHeight;
        }
      }

      function init(){
        const family = {
          name: "Life & Family Psychologist ŒõI",
          category: "Life & Family",
          description: "Supportive, structured guidance for relationships, parenting, and daily wellbeing."
        };
        const finance = {
          name: "Finance Advisor ŒõI",
          category: "Finance",
          description: "Practical budgeting, savings, and decision frameworks ‚Äî with clear caveats."
        };

        document.getElementById("personaFamily")?.addEventListener("click", ()=> setSelectedExpert(family));
        document.getElementById("personaFinance")?.addEventListener("click", ()=> setSelectedExpert(finance));

        document.getElementById("submitMvp")?.addEventListener("click", ()=>{
          setSelectedExpert(expertFromForm());
          document.getElementById("expertChatBox")?.scrollIntoView({behavior:"smooth", block:"start"});
        });

        // default persona
        setSelectedExpert(family);

        document.getElementById("expertSend")?.addEventListener("click", sendExpert);
        document.getElementById("expertMsg")?.addEventListener("keydown", (e)=>{
          if(e.key === "Enter"){
            e.preventDefault();
            sendExpert();
          }
        });
      }

      applyLang(getLang());
      document.addEventListener("DOMContentLoaded", init);
    })();
  </script>
</body>
</html>
